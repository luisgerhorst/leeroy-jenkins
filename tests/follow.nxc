#define GRAB_DEGREES 6*360+180

int turn = 0;

task main ()
{
    /* Set up */
    SetSensorLight(IN_1);
    SetSensorLight(IN_2);
    SetSensorLight(IN_3);
    SetSensorTouch(IN_4);

    int black = Sensor(IN_2);
    int white = (Sensor(IN_1) + Sensor(IN_3)) / 2;
    int blackWhiteAvergage = (black + white) / 2;
    
    /* Start */
    OnFwd(OUT_AC, 100);
    
    while (true)
        {
            if ((Sensor(IN_3) < blackWhiteAvergage) &&
                (Sensor(IN_2) > blackWhiteAvergage)) {
                    OnRev (OUT_A, 100 ) ;
                    until ((Sensor(IN_3) > blackWhiteAvergage) && (Sensor(IN_2) < blackWhiteAvergage));
                    OnFwd (OUT_A,100) ;
                }
       
       
       
            if ( (Sensor(IN_3) > blackWhiteAvergage) && (Sensor(IN_2) < blackWhiteAvergage) && (Sensor(IN_1) < blackWhiteAvergage)  ) // 90 grad nach links
                {
                    OnRev (OUT_C, 100 ) ;
                    until (  Sensor(IN_1) > blackWhiteAvergage  ) ;
                    OnFwd (OUT_C,100) ;
                    Wait (200) ;
                }
              
              
            if ( (Sensor(IN_1) > blackWhiteAvergage) && (Sensor(IN_2) < blackWhiteAvergage) && (Sensor(IN_3) < blackWhiteAvergage)  ) // 90 grad nach rechts
                {
                    OnRev (OUT_A, 100 ) ;
                    until ( Sensor(IN_3) > blackWhiteAvergage  ) ;
                    OnFwd (OUT_A,100 ) ;
                    Wait (200) ;
                }

            if ( (Sensor(IN_1) > blackWhiteAvergage) && (Sensor(IN_2) > blackWhiteAvergage) && (Sensor(IN_3) > blackWhiteAvergage)  )   // robo au√üerhalb der Linie
                {
                    if (Sensor(IN_2) < blackWhiteAvergage  && Sensor(IN_3) < blackWhiteAvergage )
                        {
                            until (Sensor(IN_3) < blackWhiteAvergage ) ;                                  // robo kommt von linker seite  der Linie
                            OnRev (OUT_C, 100 ) ;
                            until (Sensor(IN_1) > blackWhiteAvergage ) ;
                            OnFwd (OUT_C,100 ) ;
                        }
                }


              

            if ( (Sensor(IN_1) < blackWhiteAvergage) && (Sensor(IN_2) > blackWhiteAvergage)  ) {
                    OnRev (OUT_C,100);
                    until  ((Sensor(IN_1) > blackWhiteAvergage) && (Sensor(IN_2) < blackWhiteAvergage) ) ;
                    OnFwd (OUT_C,100) ;
                }
            if (IN_4==1) //Greifer
                {
                    RotateMotor(OUT_B, 100, -GRAB_DEGREES);
                    OnRev(OUT_AC,50 ) ;
                    Wait (100) ;
                    OnFwd (OUT_C , 50 ) ;
                    Wait (turn) ;
                    OnFwd (OUT_C,50 ) ;
                }
        }
}
